{"version":3,"sources":["webpack:///./src/blocks/modules/anchor-menu/anchor-menu.js"],"names":["AnchorMenu","selector","el","root","document","querySelector","_init","_matchHTML","_stickyMenu","menuItems","item","anchor","dataset","href","_clickToItem","_watcherAnchors","_scrollAfterload","header","container","closest","querySelectorAll","sidebar","mqTest","window","matchMedia","breakpoints","unmatch","destroy","getAttribute","StickySidebar","topSpacing","offsetHeight","containerSelector","innerWrapperSelector","resizeSensor","stickyClass","addEventListener","e","preventDefault","_scrollAnchors","visibleBlocks","observer","IntersectionObserver","intersectionRatio","classList","add","parentElement","scrollTo","left","offsetLeft","behavior","length","block","remove","rootMargin","threshold","observe","scrollTop","getBoundingClientRect","top","pageYOffset","offTop","match","hash","anchorMenu","state","history","pushState","location","AnchorMenuFactory","anchorMenus","push"],"mappings":"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","file":"anchor-menu.c63b.js","sourcesContent":["import StickySidebar from \"sticky-sidebar-v2\";\r\nimport { breakpoints, mqTest } from '~/js/helpers/breakpoints';\r\n\r\nexport default class AnchorMenu {\r\n    constructor(selector, el) {\r\n        this.selector = selector;\r\n        this.root = el?el:document.querySelector(`[${this.selector}]`);\r\n        if (!this.root) return false;\r\n        this._init();\r\n    }\r\n\r\n    _init() {\r\n        this._matchHTML();\r\n        this._stickyMenu();\r\n        this.menuItems.forEach(item => {\r\n            let anchor = document.querySelector(item.dataset.href);\r\n            this._clickToItem(item, anchor);\r\n            this._watcherAnchors(item, anchor);\r\n            this._scrollAfterload(item, anchor)\r\n        });\r\n\r\n    }\r\n\r\n    _matchHTML() {\r\n        this.header = document.querySelector('#header');\r\n        this.container = this.root.closest(`[${this.selector}-container]`);\r\n        this.menuItems = this.root.querySelectorAll(`[${this.selector}-item]`)\r\n    }\r\n\r\n    _stickyMenu(){\r\n        let sidebar\r\n        mqTest(window.matchMedia(`(min-width: ${breakpoints['mid-desktop']})`), {\r\n\t\t\tunmatch: () => {\r\n                if(sidebar) sidebar.destroy();\r\n                if (this.root.getAttribute(`${this.selector}`) !== \"desktop\"){\r\n                    sidebar = new StickySidebar(this.root,{\r\n                        topSpacing: this.header.offsetHeight,\r\n                        containerSelector: `[${this.selector}-container]`,\r\n                        innerWrapperSelector: `[${this.selector}-wrapper]`,\r\n                        resizeSensor: true,\r\n                        stickyClass: 'is-fixed'\r\n                    })\r\n                }\r\n\r\n\t\t\t}\r\n\t\t});\r\n    }\r\n    _clickToItem(item, anchor) {\r\n        item.addEventListener('click', (e)=>{\r\n            e.preventDefault();\r\n            this._scrollAnchors(anchor);\r\n        });\r\n    }\r\n\r\n    _watcherAnchors(item, anchor){\r\n        let visibleBlocks = document.querySelectorAll(`[${this.selector}-visible-block=\"${item.dataset.href}\"]`)\r\n        const observer = new IntersectionObserver(\r\n        ([e]) => {\r\n            if (e.intersectionRatio > 0) {\r\n                item.classList.add('is-visible')\r\n\r\n                item.parentElement.scrollTo({\r\n                    left: item.offsetLeft,\r\n                    behavior: 'smooth'\r\n                });\r\n\r\n\r\n                if(visibleBlocks.length){\r\n                    visibleBlocks.forEach(block=>{\r\n                        block.classList.add('is-visible')\r\n                    })\r\n                }\r\n                if(this.menuItems[this.menuItems.length - 1] === item) {\r\n                    this.root.classList.add('is-only-last-child')\r\n                }\r\n            } else {\r\n                item.classList.remove('is-visible')\r\n                if(visibleBlocks.length){\r\n                    visibleBlocks.forEach(block=>{\r\n                        block.classList.remove('is-visible')\r\n                    })\r\n                }\r\n                if(this.menuItems[this.menuItems.length - 1] === item) {\r\n                    this.root.classList.remove('is-only-last-child')\r\n                }\r\n            }\r\n        },{\r\n            rootMargin: -this.header.offsetHeight + 'px 0px 0px 0px',\r\n            threshold: [0]\r\n        }\r\n        );\r\n\r\n        observer.observe(anchor)\r\n    }\r\n    _scrollAnchors(anchor) {\r\n        let scrollTop = anchor.getBoundingClientRect().top + window.pageYOffset,\r\n        offTop;\r\n        mqTest(window.matchMedia(`(min-width: ${breakpoints['mid-desktop']})`), {\r\n\t\t\tmatch: () => {\r\n                offTop = this.header.offsetHeight\r\n\t\t\t},\r\n\t\t\tunmatch: () => {\r\n                offTop = this.header.offsetHeight + this.root.offsetHeight\r\n\r\n\t\t\t}\r\n\t\t});\r\n        window.scrollTo({\r\n            top: scrollTop - offTop,\r\n            behavior: 'smooth'\r\n        });\r\n    }\r\n    outsideScrollAnchors(hash) {\r\n        let anchor = document.querySelector(hash),\r\n        scrollTop = anchor.getBoundingClientRect().top + window.pageYOffset,\r\n        header = document.querySelector('#header'),\r\n        anchorMenu = document.querySelector('[data-anchor-menu=\"mobile\"]'),\r\n        offTop;\r\n        mqTest(window.matchMedia(`(min-width: ${breakpoints['desktop']})`), {\r\n\t\t\tmatch: () => {\r\n                offTop = header.offsetHeight\r\n\t\t\t},\r\n\t\t\tunmatch: () => {\r\n                if (anchorMenu) {\r\n                    offTop = header.offsetHeight + anchorMenu.offsetHeight\r\n                }\r\n\t\t\t}\r\n\t\t});\r\n        window.scrollTo({\r\n            top: scrollTop - offTop,\r\n            behavior: 'smooth'\r\n        });\r\n    }\r\n    _pushState(state){\r\n        window.history.pushState(null, null, state);\r\n    }\r\n    _scrollAfterload(item, anchor) {\r\n        if(location.hash == item.dataset.href){\r\n            this._scrollAnchors(anchor)\r\n        }\r\n    }\r\n}\r\nclass AnchorMenuFactory {\r\n    constructor(selector) {\r\n        this.anchorMenus = [];\r\n        [...document.querySelectorAll(`[${selector}]`)].forEach(el => {\r\n            this.anchorMenus.push(\r\n                new AnchorMenu(selector, el)\r\n            );\r\n        });\r\n    }\r\n}\r\n\r\nexport {AnchorMenu, AnchorMenuFactory}\r\n"],"sourceRoot":""}